<!DOCTYPE html>
<html>
<head>
<title>Labyrinth Game</title>
<style>
body { margin: 0; overflow: hidden; }
canvas { display: block; }
</style>
</head>
<body>
<script src="https://cdn.jsdelivr.net/npm/three@0.160.1/build/three.js"></script>
<script>
const map = [
"XXXXXXXXXX",
"Xs.....XXX",
"XXXXXX.XXX",
"XXXXXX.XXX",
"XXX......X",
"X.X......X",
"X.X......X",
"X.XX.XXX.X",
"X........X",
"XXXXXXXXXX"
];

const scene = new THREE.Scene();
scene.background = new THREE.Color(0x87CEEB);
const camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
const renderer = new THREE.WebGLRenderer();
renderer.setSize(window.innerWidth, window.innerHeight);
document.body.appendChild(renderer.domElement);

// Add ground
const groundGeometry = new THREE.PlaneGeometry(10, 10);
const groundMaterial = new THREE.MeshBasicMaterial({ color: 0x00ff00, side: THREE.DoubleSide });
const ground = new THREE.Mesh(groundGeometry, groundMaterial);
ground.rotation.x = -Math.PI / 2;
ground.position.set(4.5, 0, 4.5);
scene.add(ground);

// Add walls
for (let row = 0; row < 10; row++) {
    for (let col = 0; col < 10; col++) {
        if (map[row][col] === 'X') {
            const geometry = new THREE.BoxGeometry(1, 1, 1);
            const material = new THREE.MeshBasicMaterial({ color: 0x888888 });
            const cube = new THREE.Mesh(geometry, material);
            cube.position.set(col, 0.5, row);
            scene.add(cube);
        }
    }
}

// Find start
let startRow, startCol;
for (let row = 0; row < 10; row++) {
    for (let col = 0; col < 10; col++) {
        if (map[row][col] === 's') {
            startRow = row;
            startCol = col;
        }
    }
}
camera.position.set(startCol, 1.7, startRow);

// Controls
const keys = {};
document.addEventListener('keydown', (e) => { keys[e.code] = true; });
document.addEventListener('keyup', (e) => { keys[e.code] = false; });

// Mouse
let yaw = 0;
let pitch = 0;
document.addEventListener('click', () => {
    document.body.requestPointerLock();
});
document.addEventListener('mousemove', (e) => {
    if (document.pointerLockElement === document.body) {
        yaw -= e.movementX * 0.002;
        pitch -= e.movementY * 0.002;
        pitch = Math.max(-Math.PI/2, Math.min(Math.PI/2, pitch));
        camera.rotation.y = yaw;
        camera.rotation.x = pitch;
    }
});

// Movement
const speed = 0.05;
function animate() {
    requestAnimationFrame(animate);
    let dx = 0, dz = 0;
    if (keys['KeyW']) dz -= speed;
    if (keys['KeyS']) dz += speed;
    if (keys['KeyA']) dx -= speed;
    if (keys['KeyD']) dx += speed;
    const cos = Math.cos(yaw);
    const sin = Math.sin(yaw);
    const newX = camera.position.x + dx * cos - dz * sin;
    const newZ = camera.position.z + dx * sin + dz * cos;
    const col = Math.floor(newX);
    const row = Math.floor(newZ);
    if (row >= 0 && row < 10 && col >= 0 && col < 10 && map[row][col] !== 'X') {
        camera.position.x = newX;
        camera.position.z = newZ;
    }
    renderer.render(scene, camera);
}
animate();

// Resize
window.addEventListener('resize', () => {
    camera.aspect = window.innerWidth / window.innerHeight;
    camera.updateProjectionMatrix();
    renderer.setSize(window.innerWidth, window.innerHeight);
});
</script>
</body>
</html>